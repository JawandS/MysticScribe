outline_task:
  description: >
    Create a detailed chapter outline that seamlessly continues from previous chapters.

    ðŸ“‹ YOUR MISSION:
    Generate a comprehensive outline for Chapter {chapter_number} that serves as a roadmap for 2000-4000 words of engaging prose.

    ðŸ” REQUIRED PREPARATION (Use your tools):
    1. Use Knowledge Lookup tool â†’ Review story elements and world-building
    2. Use Chapter Analysis tool â†’ Check for existing draft material  
    3. Use Previous Chapter Reader tool â†’ Analyze how previous chapter ended (CRITICAL for continuity)
    4. Use Outline Management tool â†’ Check/load existing outline if action is 'expand'

    ðŸ“ CONTENT REQUIREMENTS:
    Your outline must include:
    â€¢ 3-5 distinct scenes (300-1200 words each)
    â€¢ Opening that DIRECTLY continues from previous chapter's ending
    â€¢ Specific character objectives and obstacles for each scene
    â€¢ Clear emotional progression and character development
    â€¢ Dialogue opportunities that reference recent events
    â€¢ Chapter climax with stakes and consequences
    â€¢ Ending hook that creates anticipation for next chapter

    âœ… VALIDATION CHECKLIST (Verify before submitting):
    â–¡ Outline is for Chapter {chapter_number}
    â–¡ 3-5 scenes with clear transitions
    â–¡ Opening continues from previous chapter's exact ending point
    â–¡ Character emotions consistent with previous chapter
    â–¡ Specific actions (not vague summaries like "they travel")
    â–¡ References specific previous events/character development
    â–¡ Total word count estimates: 2000-4000 words
    â–¡ Chapter ending creates natural transition to next chapter
    â–¡ No contradictions with established story canon
    â–¡ Story-specific details (not generic fantasy elements)

    ðŸš« STOP IF:
    - Cannot access previous chapter content (when chapter > 1)
    - Scenes feel episodic rather than flowing together
    - Missing specific character motivations
    - Outline could apply to any generic fantasy story

    Available Context:
    - Knowledge Base: {knowledge_context}
    - Previous Chapters: {previous_chapter_context}
    - Existing Draft: {existing_draft}
    - Existing Outline: {existing_outline}
    - Action: {outline_action}
  expected_output: >
    A comprehensive chapter outline with:
    â€¢ Scene-by-scene breakdown (3-5 scenes, 300-1200 words each)
    â€¢ Character motivations and specific objectives for each scene
    â€¢ Key dialogue topics and emotional beats
    â€¢ World-building details specific to this story
    â€¢ Pacing notes and word count estimates
    â€¢ Clear continuity connections to previous and next chapters
    â€¢ References to established story elements and character development
    
    The outline should be detailed, structured, and ready for the writer to follow as a comprehensive guide.
  agent: architect
  async: false

writing_task:
  description: >
    Transform the approved chapter outline into engaging prose that continues seamlessly from previous chapters.

    âœï¸ YOUR MISSION:
    Write Chapter {chapter_number} as 2000-4000 words of publication-ready prose that feels like the natural continuation of an ongoing story.

    ðŸ” REQUIRED PREPARATION (Use your tools):
    1. Use Previous Chapter Reader tool â†’ Understand exactly how previous chapter ended
    2. Review approved outline â†’ Follow structure while maintaining flow
    3. Verify character states, location, and emotional tone from previous chapter

    ðŸ“ WRITING REQUIREMENTS:
    â€¢ Start with "Chapter {chapter_number}: [Descriptive Title]" format
    â€¢ Use "/* /* /*" to delimit between major sections within the chapter
    â€¢ Include main characters' inner dialogue and thoughts for emotional depth
    â€¢ Maintain readable pacing - avoid excessively dense prose that overwhelms readers
    â€¢ Continue EXACTLY where previous chapter ended (same emotional state, immediate situation)
    â€¢ Follow approved outline structure while allowing natural character development
    â€¢ Use authentic dialogue that reflects each character's unique voice
    â€¢ Include vivid sensory details and show-don't-tell techniques
    â€¢ Build tension naturally while advancing the plot meaningfully
    â€¢ End with natural transition point for next chapter

    âœ… VALIDATION CHECKLIST (Verify before submitting):
    â–¡ Word count: 2000-4000 words
    â–¡ Opening seamlessly continues from previous chapter
    â–¡ Character dialogue feels authentic and distinct
    â–¡ All names/locations match established canon
    â–¡ No anachronisms or modern language in fantasy setting
    â–¡ Action scenes are clear and engaging
    â–¡ Emotional beats feel genuine and earned
    â–¡ Maintains consistent point of view throughout
    â–¡ Uses vivid sensory details
    â–¡ Chapter ending provides satisfying pause

    ðŸš« STOP IF:
    - Cannot access approved outline or previous chapter content
    - Opening feels like fresh start rather than continuation
    - Characters act inconsistently with established personalities
    - Word count outside 1800-4200 range
    - Dialogue feels generic or interchangeable

    ðŸŽ¯ OUTPUT FORMAT:
    Return the complete chapter starting with "Chapter {chapter_number}: [Title]" followed by the prose content. 
    Use "/* /* /*" to separate major sections. Include character inner thoughts and maintain readable pacing.

    Available Context:
    - Knowledge Base: {knowledge_context}
    - Previous Chapters: {previous_chapter_context}
    - Approved Outline: {approved_outline}
  expected_output: >
    Complete chapter prose (2000-4000 words) starting with "Chapter {chapter_number}: [Title]" followed by 
    the chapter content. Use "/* /* /*" to delimit between major sections. Include main characters' inner 
    dialogue and thoughts to provide emotional depth. Maintain readable pacing - avoid excessively dense 
    writing that overwhelms readers. The chapter should be publication-ready with natural character 
    interactions, vivid descriptions, compelling narrative arc, and seamless continuation from previous chapters.
  agent: writer

editing_task:
  description: >
    Polish the chapter draft into publication-ready prose with natural human style while maintaining perfect continuity.

    âœï¸ YOUR MISSION:
    Transform Chapter {chapter_number} into professional-quality prose (2000-4000 words) that reads like it was written by the same skilled author throughout the series.

    ðŸ” REQUIRED PREPARATION (Use your tools):
    1. Use Previous Chapter Reader tool â†’ Verify continuity and analyze established writing style
    2. Use Style Analysis tool â†’ Get detailed analysis of writing patterns from previous chapters
    3. Use Style Guide tool â†’ Review guidelines for consistent tone and voice

    ðŸ“ EDITING FOCUS:
    CONTENT REFINEMENT:
    â€¢ Ensure proper chapter format: "Chapter {chapter_number}: [Title]"
    â€¢ Verify "/* /* /*" delimiters separate major sections appropriately
    â€¢ Include and enhance main characters' inner dialogue for emotional depth
    â€¢ Maintain readable pacing - break up overly dense passages with dialogue or action
    â€¢ Enhance prose clarity, rhythm, and emotional resonance
    â€¢ Strengthen scene transitions, especially opening from previous chapter  
    â€¢ Make dialogue authentic and character-specific
    â€¢ Cut verbose sections, expand thin areas as needed
    â€¢ Ensure satisfying emotional/plot beat at chapter end

    STYLE CONSISTENCY:
    â€¢ Match sentence rhythm patterns from previous chapters
    â€¢ Use similar metaphorical language and imagery style
    â€¢ Maintain established atmospheric detail level
    â€¢ Keep character dialogue voices consistent
    â€¢ Preserve established pacing between action/contemplation

    AI PATTERN ELIMINATION:
    â€¢ Remove robotic or formulaic sentence structures
    â€¢ Eliminate dashes (-) and AI hallmark phrases
    â€¢ Vary sentence length organically
    â€¢ Replace generic descriptions with specific, evocative details
    â€¢ Create natural speech patterns with realistic interruptions

    âœ… VALIDATION CHECKLIST (Verify before submitting):
    â–¡ Starts with "Chapter {chapter_number}: [Title]" format
    â–¡ Uses "/* /* /*" to delimit major sections
    â–¡ Includes main characters' inner thoughts and dialogue
    â–¡ Maintains readable pacing without overly dense passages
    â–¡ Word count: 2000-4000 words exactly
    â–¡ Opening flows seamlessly from previous chapter
    â–¡ All character voices consistent and authentic
    â–¡ No AI patterns or formulaic language remains
    â–¡ Style matches previous chapters perfectly
    â–¡ Dialogue feels natural with realistic flow
    â–¡ Action sequences visceral and immediate
    â–¡ Emotional beats genuine and earned
    â–¡ World-building naturally integrated
    â–¡ Chapter ending creates anticipation
    â–¡ No grammatical errors or typos
    â–¡ Consistent point of view maintained
    â–¡ Sensory details vivid and specific

    ðŸš« STOP IF:
    - Cannot access previous chapters for style analysis
    - Original has unfixable plot inconsistencies
    - Character voices inconsistent and unfixable
    - Word count falls outside acceptable range after editing
    - Style feels jarring compared to previous chapters

    ðŸŽ¯ OUTPUT FORMAT:
    Return the complete chapter starting with "Chapter {chapter_number}: [Title]" format. Use "/* /* /*" 
    to separate major sections. Must include character inner thoughts and maintain readable pacing throughout.

    Available Context:
    - Previous Chapters: {previous_chapter_context}
  expected_output: >
    Complete, polished chapter starting with "Chapter {chapter_number}: [Title]" format. Use "/* /* /*" 
    to delimit major sections. Include main characters' inner dialogue and thoughts for emotional depth. 
    Maintain readable pacing without excessively dense writing. The chapter should read like it was written 
    by an experienced human fantasy author with perfect continuity from previous chapters, natural human 
    prose with no AI patterns, and consistent authorial voice throughout the series. Ready to save directly 
    as chapter content (2000-4000 words).
  agent: editor

